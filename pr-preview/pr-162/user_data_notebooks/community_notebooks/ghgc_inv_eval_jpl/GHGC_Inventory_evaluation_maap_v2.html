<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.43">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Evaluation of Methane Emissions Inventory Using Satellite Flux Inversions – U.S. Greenhouse Gas Center Documentation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-d4d76bf8491c20bad77d141916dc28e1.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark-4379b0ccadffce622b03caf4c46266b3.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-116a9cf2811581fb0f0cc9bc679d9f53.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-dark-2fd190d4921cceb30037869a1646437f.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Evaluation of Methane Emissions Inventory Using Satellite Flux Inversions</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../../../index.html" class="sidebar-logo-link">
      <img src="../../../logo/ghgc-logo-light.svg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main tools-wide">
    <a href="https://earth.gov/ghgcenter" title="US GHG Center Website" class="quarto-navigation-tool px-1" aria-label="US GHG Center Website"><i class="bi bi-globe-americas"></i></a>
    <a href="https://github.com/us-ghg-center/ghgc-docs" title="Repository home" class="quarto-navigation-tool px-1" aria-label="Repository home"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">User Services</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../services/apis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">APIs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../services/jupyterhub.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">JupyterHub</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../datausage.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Usage Notebooks</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">GHG Center Dataset Tutorials</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../user_data_notebooks/eccodarwin-co2flux-monthgrid-v5_User_Notebook.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Air-Sea CO<sub>2</sub> Flux, ECCO-Darwin Model v5</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../user_data_notebooks/noaa-insitu_User_Notebook.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Atmospheric Carbon Dioxide Concentrations from the NOAA Global Monitoring Laboratory</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../user_data_notebooks/influx-testbed-ghg-concentrations_User_Notebook.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Carbon Dioxide and Methane Concentrations from the Indianapolis Flux Experiment (INFLUX)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../user_data_notebooks/lam-testbed-ghg-concentrations_User_Notebook.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Carbon Dioxide and Methane Concentrations from the Los Angeles Megacity Carbon Project</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../user_data_notebooks/nec-testbed-ghg-concentrations_User_Notebook.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Carbon Dioxide and Methane Concentrations from the Northeast Corridor (NEC) Urban Test Bed</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../user_data_notebooks/ct-ch4-monthgrid-v2023_User_Notebook.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CarbonTracker-CH₄ Isotopic Methane Inverse Fluxes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../user_data_notebooks/emit-ch4plume-v1_User_Notebook.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EMIT Methane Point Source Plume Complexes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../user_data_notebooks/goes-ch4plume-v1_User_Notebook.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Geostationary Satellite Observations of Extreme and Transient Methane Emissions from Oil and Gas Infrastructure</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../user_data_notebooks/gosat-based-ch4budget-yeargrid-v1_User_Notebook.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GOSAT-based Top-down Total and Natural Methane Emissions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../user_data_notebooks/gra2pes-ghg-monthgrid-v1_User_Notebook.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GRA²PES Greenhouse Gas and Air Quality Species</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../user_data_notebooks/micasa-carbonflux-daygrid-v1_User_Notebook.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MiCASA Land Carbon Flux</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../user_data_notebooks/oco2geos-co2-daygrid-v10r_User_Notebook.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">OCO-2 GEOS Column CO₂ Concentrations</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">OCO-2 MIP Top-Down CO<sub>2</sub> Budgets</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../user_data_notebooks/oco2-mip-co2budget-yeargrid-v1_User_Notebook.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introductory notebook</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../user_data_notebooks/oco2-mip-National-co2budget.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Intermediate level notebook</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../user_data_notebooks/odiac-ffco2-monthgrid-v2023_User_Notebook.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ODIAC Fossil Fuel CO₂ Emissions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../user_data_notebooks/sedac-popdensity-yeargrid5yr-v4.11_User_Notebook.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SEDAC Gridded World Population Density</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../user_data_notebooks/epa-ch4emission-grid-v2express_User_Notebook.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">U.S. Gridded Anthropogenic Methane Emissions Inventory</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../user_data_notebooks/vulcan-ffco2-yeargrid-v4_User_Notebook.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vulcan Fossil Fuel CO₂ Emissions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../user_data_notebooks/lpjeosim-wetlandch4-grid-v1_User_Notebook.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Wetland Methane Emissions, LPJ-EOSIM Model</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Community-Contributed Tutorials</span></span>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../datatransformationcode.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Transformation Notebooks</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../cog_transformation/eccodarwin-co2flux-monthgrid-v5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Air-Sea CO₂ Flux, ECCO-Darwin Model v5</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../cog_transformation/noaa-gggrn-concentrations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Atmospheric Carbon Dioxide and Methane Concentrations from the NOAA Global Monitoring Laboratory</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../cog_transformation/influx-testbed-ghg-concentrations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Carbon Dioxide and Methane Concentrations from the Indianapolis Flux Experiment (INFLUX)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../cog_transformation/lam-testbed-ghg-concentrations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Carbon Dioxide and Methane Concentrations from the Los Angeles Megacity Carbon Project</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../cog_transformation/nec-testbed-ghg-concentrations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Carbon Dioxide and Methane Concentrations from the Northeast Corridor (NEC) Urban Test Bed</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../cog_transformation/ct-ch4-monthgrid-v2023.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CarbonTracker-CH₄ Isotopic Methane Inverse Fluxes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../cog_transformation/emit-ch4plume-v1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EMIT Methane Point Source Plume Complexes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../cog_transformation/goes-ch4plume-v1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Geostationary Satellite Observations of Extreme and Transient Methane Emissions from Oil and Gas Infrastructure</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../cog_transformation/gosat-based-ch4budget-yeargrid-v1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GOSAT-based Top-down Total and Natural Methane Emissions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../cog_transformation/gra2pes-ghg-monthgrid-v1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GRA²PES Greenhouse Gas and Air Quality Species</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../cog_transformation/oco2geos-co2-daygrid-v10r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">OCO-2 GEOS Column CO₂ Concentrations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../cog_transformation/oco2-mip-co2budget-yeargrid-v1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">OCO-2 MIP Top-Down CO₂ Budgets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../cog_transformation/odiac-ffco2-monthgrid-v2023.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ODIAC Fossil Fuel CO₂ Emissions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../cog_transformation/sedac-popdensity-yeargrid5yr-v4.11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SEDAC Gridded World Population Density</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../cog_transformation/epa-ch4emission-grid-v2express.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">U.S. Gridded Anthropogenic Methane Emissions Inventory</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../cog_transformation/vulcan-ffco2-yeargrid-v4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vulcan Fossil Fuel CO₂ Emissions</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../processingreport.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Processing and Verification Reports</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../processing_and_verification_reports/eccodarwin-co2flux-monthgrid-v5_Processing and Verification Report.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Air-Sea CO₂ Flux, ECCO-Darwin Model v5</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../processing_and_verification_reports/noaa-gggrn-co2-concentrations_Processing and Verification Report.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Atmospheric Carbon Dioxide Concentrations from the NOAA Global Monitoring Laboratory</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../processing_and_verification_reports/noaa-gggrn-ch4-concentrations_Processing and Verification Report.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Atmospheric Methane Concentrations from the NOAA Global Monitoring Laboratory</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../processing_and_verification_reports/influx-testbed-ghg-concentrations_Processing and Verification Report.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Carbon Dioxide and Methane Concentrations from the Indianapolis Flux Experiment (INFLUX)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../processing_and_verification_reports/lam-testbed-ghg-concentrations_Processing and Verification Report.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Carbon Dioxide and Methane Concentrations from the Los Angeles Megacity Carbon Project</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../processing_and_verification_reports/nec-testbed-ghg-concentrations_Processing and Verification Report.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Carbon Dioxide and Methane Concentrations from the Northeast Corridor (NEC) Urban Test Bed</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../processing_and_verification_reports/ct-ch4-monthgrid-v2023_Processing and Verification Report.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CarbonTracker-CH₄ Isotopic Methane Inverse Fluxes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../processing_and_verification_reports/emit-ch4plume-v1_Processing and Verification Report.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EMIT Methane Point Source Plume Complexes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../processing_and_verification_reports/goes-ch4plume-v1_Processing and Verification Report.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Geostationary Satellite Observations of Extreme and Transient Methane Emissions from Oil and Gas Infrastructure</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../processing_and_verification_reports/gosat-based-ch4budget-yeargrid-v1_Processing and Verification Report.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GOSAT-based Top-down Total and Natural Methane Emissions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../processing_and_verification_reports/gra2pes-ghg-monthgrid-v1_Processing and Verification Report.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GRA²PES Greenhouse Gas and Air Quality Species</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../processing_and_verification_reports/micasa-carbonflux-daygrid-v1_Processing and Verification Report.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MiCASA Land Carbon Flux</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../processing_and_verification_reports/oco2geos-co2-daygrid-v10r_Processing and Verification Report.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">OCO-2 GEOS Column CO₂ Concentrations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../processing_and_verification_reports/oco2-mip-co2budget-yeargrid-v1_Processing and Verification Report.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">OCO-2 MIP Top-Down CO₂ Budgets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../processing_and_verification_reports/odiac-ffco2-monthgrid-v2023_Processing and Verification Report.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ODIAC Fossil Fuel CO₂ Emissions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../processing_and_verification_reports/sedac-popdensity-yeargrid5yr-v4.11_Processing and Verification Report.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SEDAC Gridded World Population Density</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../processing_and_verification_reports/epa-ch4emission-grid-v2express_Processing and Verification Report.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gridded Anthropogenic Methane Emissions Inventory</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../processing_and_verification_reports/vulcan-ffco2-yeargrid-v4_Processing and Verification Report.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vulcan Fossil Fuel CO₂ Emissions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../processing_and_verification_reports/lpjeosim-wetlandch4-grid-v1_Processing and Verification Report.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Wetland Methane Emissions, LPJ-EOSIM Model</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Flow Diagrams</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../data_workflow/eccodarwin-co2flux-monthgrid-v5_Data_Flow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Air-Sea CO₂ Flux, ECCO-Darwin Model v5</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../data_workflow/noaa-gggrn-co2-concentrations_Data_Flow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Atmospheric Carbon Dioxide Concentrations from the NOAA Global Monitoring Laboratory</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../data_workflow/noaa-gggrn-ch4-concentrations_Data_Flow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Atmospheric Methane Concentrations from the NOAA Global Monitoring Laboratory</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../data_workflow/influx-testbed-ghg-concentrations_Data_Flow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Carbon Dioxide and Methane Concentrations from the Indianapolis Flux Experiment (INFLUX)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../data_workflow/lam-testbed-ghg-concentrations_Data_Flow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Carbon Dioxide and Methane Concentrations from the Los Angeles Megacity Carbon Project</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../data_workflow/nec-testbed-ghg-concentrations_Data_Flow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Carbon Dioxide and Methane Concentrations from the Northeast Corridor (NEC) Urban Test Bed</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../data_workflow/ct-ch4-monthgrid-v2023_Data_Flow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CarbonTracker-CH₄ Isotopic Methane Inverse Fluxes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../data_workflow/emit-ch4plume-v1_Data_Flow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EMIT Methane Point Source Plume Complexes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../data_workflow/goes-ch4plume-v1_Data_Flow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Geostationary Satellite Observations of Extreme and Transient Methane Emissions from Oil and Gas Infrastructure</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../data_workflow/gosat-based-ch4budget-yeargrid-v1_Data_Flow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GOSAT-based Top-down Total and Natural Methane Emissions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../data_workflow/gra2pes-ghg-monthgrid-v1_Data_Flow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GRA²PES Greenhouse Gas and Air Quality Species</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../data_workflow/micasa-carbonflux-daygrid-v1_Data_Flow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MiCASA Land Carbon Flux - Data Workflow</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../data_workflow/oco2geos-co2-daygrid-v10r_Data_Flow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">OCO-2 GEOS Column CO₂ Concentrations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../data_workflow/oco2-mip-co2budget-yeargrid-v1_Data_Flow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">OCO-2 MIP Top-Down CO₂ Budgets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../data_workflow/odiac-ffco2-monthgrid-v2023_Data_Flow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ODIAC Fossil Fuel CO₂ Emissions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../data_workflow/sedac-popdensity-yeargrid5yr-v4.11_Data_Flow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SEDAC Gridded World Population Density</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../data_workflow/epa-ch4emission-grid-v2express_Data_Flow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">U.S. Gridded Anthropogenic Methane Emissions Inventory</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../data_workflow/vulcan-ffco2-yeargrid-v4_Data_Flow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vulcan Fossil Fuel CO₂ Emissions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../data_workflow/lpjeosim-wetlandch4-grid-v1_Data_Flow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Wetland Methane Emissions, LPJ-EOSIM Model</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#authors-sudhanshu-pandey-john-worden" id="toc-authors-sudhanshu-pandey-john-worden" class="nav-link active" data-scroll-target="#authors-sudhanshu-pandey-john-worden">Authors: Sudhanshu Pandey, John Worden</a></li>
  <li><a href="#correspondence-sudhanshu-pandey-sudhanshu.pandeyjpl.nasa.gov" id="toc-correspondence-sudhanshu-pandey-sudhanshu.pandeyjpl.nasa.gov" class="nav-link" data-scroll-target="#correspondence-sudhanshu-pandey-sudhanshu.pandeyjpl.nasa.gov">Correspondence: Sudhanshu Pandey (sudhanshu.pandey@jpl.nasa.gov)</a></li>
  <li><a href="#executive-summary" id="toc-executive-summary" class="nav-link" data-scroll-target="#executive-summary">Executive Summary</a>
  <ul class="collapse">
  <li><a href="#key-concepts" id="toc-key-concepts" class="nav-link" data-scroll-target="#key-concepts">Key Concepts</a></li>
  </ul></li>
  <li><a href="#intended-user" id="toc-intended-user" class="nav-link" data-scroll-target="#intended-user">Intended User</a>
  <ul class="collapse">
  <li><a href="#accounting-for-the-averaging-kernel-truth-sensitivity-in-atmospheric-flux-inversion-emission-estimates" id="toc-accounting-for-the-averaging-kernel-truth-sensitivity-in-atmospheric-flux-inversion-emission-estimates" class="nav-link" data-scroll-target="#accounting-for-the-averaging-kernel-truth-sensitivity-in-atmospheric-flux-inversion-emission-estimates">Accounting for the Averaging Kernel (Truth Sensitivity) in Atmospheric Flux Inversion Emission Estimates</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></li>
  <li><a href="#initialize" id="toc-initialize" class="nav-link" data-scroll-target="#initialize">Initialize</a></li>
  <li><a href="#epa-inventory" id="toc-epa-inventory" class="nav-link" data-scroll-target="#epa-inventory">EPA inventory</a>
  <ul class="collapse">
  <li><a href="#data-dictionary-keys-description" id="toc-data-dictionary-keys-description" class="nav-link" data-scroll-target="#data-dictionary-keys-description">Data Dictionary Keys Description</a></li>
  </ul></li>
  <li><a href="#edgar-inventory" id="toc-edgar-inventory" class="nav-link" data-scroll-target="#edgar-inventory">EDGAR inventory</a></li>
  <li><a href="#fog-oilgas-fuel-inventory" id="toc-fog-oilgas-fuel-inventory" class="nav-link" data-scroll-target="#fog-oilgas-fuel-inventory">FOG Oil/Gas Fuel Inventory</a>
  <ul class="collapse">
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.dev/us-ghg-center/ghgc-docs/blob/main/user_data_notebooks/community_notebooks/ghgc_inv_eval_jpl/GHGC_Inventory_evaluation_maap_v2.ipynb" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/us-ghg-center/ghgc-docs/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Evaluation of Methane Emissions Inventory Using Satellite Flux Inversions</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="authors-sudhanshu-pandey-john-worden" class="level3">
<h3 class="anchored" data-anchor-id="authors-sudhanshu-pandey-john-worden">Authors: Sudhanshu Pandey, John Worden</h3>
</section>
<section id="correspondence-sudhanshu-pandey-sudhanshu.pandeyjpl.nasa.gov" class="level3">
<h3 class="anchored" data-anchor-id="correspondence-sudhanshu-pandey-sudhanshu.pandeyjpl.nasa.gov">Correspondence: Sudhanshu Pandey (sudhanshu.pandey@jpl.nasa.gov)</h3>
<p>Jet Propulsion Laboratory, California Institute of Technology, Pasadena, CA 91109, USA</p>
<p><strong>Copyright</strong> [2024], by the California Institute of Technology. ALL RIGHTS RESERVED. United States Government Sponsorship acknowledged. Any commercial use must be negotiated with the Office of Technology Transfer at the California Institute of Technology.</p>
<p>This software may be subject to U.S. export control laws. By accepting this software, the user agrees to comply with all applicable U.S. export laws and regulations. User has the responsibility to obtain export licenses, or other export authority as may be required before exporting such information to foreign countries or providing access to foreign persons.</p>
</section>
<section id="executive-summary" class="level2">
<h2 class="anchored" data-anchor-id="executive-summary">Executive Summary</h2>
<p>This notebook presents a comprehensive evaluation of gridded methane emission inventories using atmospheric flux inversions based on GOSAT (Greenhouse gases Observing SATellite) concentration measurements. It demonstrates how to account for the truth sensitivity (averaging kernel) of atmospheric flux inversions and provides an in-depth comparison between bottom-up inventories and satellite-derived emissions. The GOSAT flux inversion data utilized are sourced from Qu et al.&nbsp;(2024).</p>
<section id="key-concepts" class="level3">
<h3 class="anchored" data-anchor-id="key-concepts">Key Concepts</h3>
<ul>
<li><strong>Bayesian Method:</strong>
<ul>
<li>The flux inversion data are spatially and temporally disaggregated using a Bayesian framework, as described in Worden et al.&nbsp;(2023).</li>
</ul></li>
<li><strong>Averaging Kernel (AK):</strong>
<ul>
<li>A metric that quantifies the extent to which flux inversions can “see” or detect the actual emissions of gases like methane in the atmosphere.</li>
<li>Indicates how accurately the inversion captures true emission amounts, given the satellite data coverage and the uncertainties in observational data and transport models.</li>
<li>Reflects the degree to which the flux inversion estimate (posterior) depends on actual observations versus prior emission estimates.</li>
</ul></li>
</ul>
<hr>
</section>
</section>
<section id="intended-user" class="level2">
<h2 class="anchored" data-anchor-id="intended-user">Intended User</h2>
<p>The intended user should ideally be knowledgeable about inverse problems or possess the technical skills to learn the basics of inverse problems.</p>
<hr>
<section id="accounting-for-the-averaging-kernel-truth-sensitivity-in-atmospheric-flux-inversion-emission-estimates" class="level3">
<h3 class="anchored" data-anchor-id="accounting-for-the-averaging-kernel-truth-sensitivity-in-atmospheric-flux-inversion-emission-estimates">Accounting for the Averaging Kernel (Truth Sensitivity) in Atmospheric Flux Inversion Emission Estimates</h3>
<p>Top-down approaches like satellite-based flux inversions play a crucial role in estimating greenhouse gas emissions by constraining them with atmospheric concentration measurements. These methods enable the evaluation and enhancement of bottom-up emission inventories. Flux inversions use chemical transport models to link atmospheric concentration data—gathered from satellites or ground-based stations—to the underlying emissions. Within a Bayesian framework, they integrate prior emission estimates with observational data to generate optimal posterior emission estimates.</p>
<p>The posterior emission estimates from flux inversions can assess the accuracy of bottom-up inventories concerning annual total emissions, spatial and sectoral emission distributions, and emission trends over time. However, when comparing these estimates to inventories, it’s essential to consider the flux inversion’s sensitivity to the true emissions. This sensitivity is represented by the <strong>averaging kernel matrix</strong> (also known as the inversion operator).</p>
<section id="posterior-solution-of-a-flux-inversion" class="level4">
<h4 class="anchored" data-anchor-id="posterior-solution-of-a-flux-inversion">Posterior Solution of a Flux Inversion</h4>
<p>The posterior solution of a flux inversion is essentially an error-weighted average of prior emissions and observational data. To evaluate an emission inventory using flux inversion results, we apply the flux inversion operator to the inventory emissions. In this context, we assume that the inventory represents the true emissions for comparison purposes. The estimated emissions are calculated as:</p>
<p><span class="math display">\[
x_{\text{inv\_est}} = x_a + A (x_{\text{inv}} - x_a)
\]</span></p>
<p><strong>Where:</strong> - $ x_{} $: Estimated emissions after applying the flux inversion operator to the inventory emissions. - $ x_a $: Prior emissions used in the inversion. - $ A $: Averaging kernel matrix representing the flux inversion operator. - $ x_{} $: Emissions from the inventory being evaluated.</p>
<p>This equation indicates that the estimated emissions $ x_{} $ are obtained by adjusting the prior emissions $ x_a $ based on the difference between the inventory emissions $ x_{} $ and the prior emissions, weighted by the averaging kernel $ A $.</p>
<hr>
</section>
<section id="covariance-matrix-of-the-estimated-emissions" class="level4">
<h4 class="anchored" data-anchor-id="covariance-matrix-of-the-estimated-emissions">Covariance Matrix of the Estimated Emissions</h4>
<p>The uncertainty associated with the estimated emissions is described by the covariance matrix $ S_{} $, which accounts for uncertainties in the inventory emissions, observational errors, and model errors:</p>
<p><span class="math display">\[
S_{\text{inv\_est}} = A S_{\text{inv}} A^T + S_{\text{obs}} + S_{\text{model}}
\]</span></p>
<p><strong>Where:</strong> -$ S_{} $: Error covariance matrix of the estimated emissions $ x_{} $. - $ S_{} $: Covariance matrix of the inventory emissions $ x_{} $. - $ S_{} $: Covariance matrix of the observational errors. - $ S_{} $: Covariance matrix of the transport model errors.</p>
<p>For our calculations, we assume that the model errors are equal to the observational errors, so $ S_{} = S_{} $.</p>
<hr>
</section>
</section>
<section id="references" class="level3">
<h3 class="anchored" data-anchor-id="references">References</h3>
<ul>
<li>Worden, J. R., Pandey, S., Zhang, Y., Cusworth, D. H., Qu, Z., Bloom, A. A., Ma, S., Maasakkers, J. D., Byrne, B., Duren, R., Crisp, D., Gordon, D., and Jacob, D. J.: Verifying Methane Inventories and Trends With Atmospheric Methane Data, AGU Adv., 4, https://doi.org/10.1029/2023AV000871, 2023.</li>
<li>Worden, J. R., Cusworth, D. H., Qu, Z., Yin, Y., Zhang, Y., Bloom, A. A., Ma, S., Byrne, B. K., Scarpelli, T., Maasakkers, J. D., Crisp, D., Duren, R., and Jacob, D. J.: The 2019 methane budget and uncertainties at 1° resolution and each country through Bayesian integration Of GOSAT total column methane data and a priori inventory estimates, Atmos. Chem. Phys., 22, 6811–6841, https://doi.org/10.5194/acp-22-6811-2022, 2022.</li>
<li>Qu, Z., Jacob, D. J., Bloom, A. A., Worden, J. R., Parker, R. J., and Boesch, H.: Inverse modeling of 2010–2022 satellite observations shows that inundation of the wet tropics drove the 2020–2022 methane surge, Proc. Natl. Acad. Sci., 121, e2402730121, https://doi.org/10.1073/pnas.2402730121, 2024.</li>
</ul>
</section>
</section>
<section id="initialize" class="level1">
<h1>Initialize</h1>
<div id="cell-9" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import necessary libraries for data manipulation and visualization</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>load_ext autoreload </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>autoreload <span class="dv">2</span>  </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pylab <span class="im">import</span> <span class="op">*</span>  <span class="co"># Import the pylab interface from matplotlib for MATLAB-like syntax</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> xarray <span class="im">as</span> xr  <span class="co"># Import xarray to work with labeled multi-dimensional arrays</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cartopy.crs <span class="im">as</span> ccrs  <span class="co"># Import cartopy's coordinate reference systems for mapping</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cartopy.feature <span class="im">as</span> cfeature  <span class="co"># Import cartopy features for adding geographical elements to maps</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats  <span class="co"># Import statistical functions from scipy's stats module</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> inventory_evaluation_helper <span class="im">import</span> <span class="op">*</span>  <span class="co"># Import all functions from the inventory evaluation helper module</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">'ignore'</span>)  <span class="co"># Ignore warnings for a cleaner output</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np  <span class="co"># Added explicit import for numerical operations</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd  <span class="co"># Added pandas for data handling</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-10" class="cell" data-tags="[]" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the analysis year for the data extraction</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>analysis_year <span class="op">=</span> <span class="dv">2015</span>  <span class="co"># Currently, only the year 2015 data is available with the notebook.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-11" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>data_folder_path <span class="op">=</span> <span class="st">"./GOSAT_inventroy_eval_data/"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here, GOSAT flux inversion results are loaded. These contain the sectorally-disaggregated posterior emissions, their covariances, and the averaging kernel of the flux inversion.</p>
<div id="cell-13" class="cell" data-tags="[]" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Call the function to load GOSAT inversion data for the specified year</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># The function `giveGOSATdata` returns a dictionary containing the GOSAT inversion data</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>ana_dict <span class="op">=</span> giveGOSATdata(data_folder_path, analysis_year)  <span class="co"># Load GOSAT inversion data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Loading GOSAT Data</code></pre>
</div>
</div>
</section>
<section id="epa-inventory" class="level1">
<h1>EPA inventory</h1>
<p>U.S. Inventory of Greenhouse Gas Emissions and Sinks (U.S. GHGI). This analysis uses 2015 U.S. GHGI, spatially allocated as described in Maasakkers et al.&nbsp;(2023). ### Reference Maasakkers, J. D., McDuffie, E. E., Sulprizio, M. P., Chen, C., Schultz, M., Brunelle, L., Thrush, R., Steller, J., Sherry, C., Jacob, D. J., Jeong, S., Irving, B., and Weitz, M.: A Gridded Inventory of Annual 2012-2018 U.S. Anthropogenic Methane Emissions, Environ. Sci. Technol., 57, 16276–16288, https://doi.org/10.1021/acs.est.3c05138, 2023.</p>
<div id="cell-15" class="cell" data-tags="[]" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Retrieve EPA inventory data and store it in `epa_dict`</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>epa_data_path <span class="op">=</span> data_folder_path <span class="op">+</span> <span class="ss">f"/EPA/Gridded_GHGI_Methane_v2_</span><span class="sc">{</span>analysis_year<span class="sc">}</span><span class="ss">.nc"</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>epa_dict <span class="op">=</span> getEPADict(epa_data_path)  <span class="co"># Retrieve EPA inventory data</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate and retrieve error parameters for the EPA data based on `epa_dict`</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>epa_error_params <span class="op">=</span> getEPAErrorParams(epa_dict)  <span class="co"># Retrieve EPA error parameters</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Cluster EPA data to GOSAT data using the retrieved EPA error parameters</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co"># This step aligns the EPA inventory data with the GOSAT inversion data based on spatial co-location.</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>ana_dict <span class="op">=</span> clusterEPA2GOSAT(ana_dict, epa_dict, epa_error_params)  <span class="co"># Cluster EPA data to GOSAT</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Loading EPA Data
Loading EPA Error Parameters
Clustering EPA data to GOSAT Grid Resolution</code></pre>
</div>
</div>
<div id="cell-16" class="cell" data-tags="[]" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform AK correction as per Worden et al. 2023</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This step adjusts the ana_dict data using the AK correction method, focusing on the "x_epa" and "S_epa" variables.</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>ana_dict <span class="op">=</span> performAKcorrection(ana_dict, x_var<span class="op">=</span><span class="st">"x_epa"</span>, S_var<span class="op">=</span><span class="st">"S_epa"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Performing GOSAT flux inversions AK Correction</code></pre>
</div>
</div>
<section id="data-dictionary-keys-description" class="level3">
<h3 class="anchored" data-anchor-id="data-dictionary-keys-description">Data Dictionary Keys Description</h3>
<p>The ana_dict_“inv” dictionary used in this notebook contains several keys, each representing different aspects of the methane emissions data.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 70%">
<col style="width: 22%">
</colgroup>
<thead>
<tr class="header">
<th>Key</th>
<th>Description</th>
<th>Data Type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>lon</strong></td>
<td>Represents the longitude coordinates of the data points.</td>
<td>Array of float values</td>
</tr>
<tr class="even">
<td><strong>lat</strong></td>
<td>Represents the latitude coordinates of the data points.</td>
<td>Array of float values</td>
</tr>
<tr class="odd">
<td><strong>cat</strong></td>
<td>Category labels for different emission sectors.</td>
<td>Array of strings</td>
</tr>
<tr class="even">
<td><strong>x_est</strong></td>
<td>Estimated emissions values obtained from the inversion process.</td>
<td>Array of float values</td>
</tr>
<tr class="odd">
<td><strong>x_a</strong></td>
<td>Prior emissions values used as input to the inversion process.</td>
<td>Array of float values</td>
</tr>
<tr class="even">
<td><strong>S_a</strong></td>
<td>Covariance matrix of the prior emissions values, indicating uncertainties.</td>
<td>2D array of float values</td>
</tr>
<tr class="odd">
<td><strong>S_x</strong></td>
<td>Covariance matrix of the estimated emissions values, indicating uncertainties.</td>
<td>2D array of float values</td>
</tr>
<tr class="even">
<td><strong>AK</strong></td>
<td>Averaging Kernel matrix, representing the sensitivity of the posterior estimates to the true emissions.</td>
<td>2D array of float values</td>
</tr>
<tr class="odd">
<td><strong>x_inv</strong></td>
<td>Emissions values from the inventory.</td>
<td>Array of float values</td>
</tr>
<tr class="even">
<td><strong>error_S_inv</strong></td>
<td>Error covariance matrix for the emissions values.</td>
<td>2D array of float values</td>
</tr>
<tr class="odd">
<td><strong>x_inv_est</strong></td>
<td>Emissions values from the inventory with application of inversion’s AK</td>
<td>Array of float values</td>
</tr>
<tr class="even">
<td><strong>S_inv_est</strong></td>
<td>Error covariance matrix for the EPA emissions values with application of inversion’s AK.</td>
<td>2D array of float values</td>
</tr>
</tbody>
</table>
<p>Here, “inv” denotes an inventory, EDGAR, EPA or FOG</p>
<div id="cell-18" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a bar plot to compare the EPA inventory data with the GOSAT inversion data</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>makeBarPlot(ana_dict, epa_error_params, inventory<span class="op">=</span><span class="st">"epa"</span>, analysis_year<span class="op">=</span>analysis_year)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Country United States not found in the shapefile.
Country United States not found in the shapefile.
Country United States not found in the shapefile.
Country United States not found in the shapefile.</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GHGC_Inventory_evaluation_maap_v2_files/figure-html/cell-8-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>In the bar plot, the difference between the orange and green bars is due to the averaging kernel of the GOSAT flux inversion. The orange bar should be compared with the GOSAT estimates (blue bars).</p>
<div id="cell-20" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a GeoPandas DataFrame from the analysis dictionary for the "epa" inventory</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>gdf_epa <span class="op">=</span> makeGeoPandasDataFrame(ana_dict, inventory<span class="op">=</span><span class="st">"epa"</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (<span class="st">"****The output is a scrollable list of maps.***"</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ipywidgets <span class="im">import</span> Output</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over each unique category in the 'cat' column of the GeoPandas DataFrame</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>out <span class="op">=</span> Output(layout<span class="op">=</span>{<span class="st">'overflow_y'</span>: <span class="st">'scroll'</span>, <span class="st">'height'</span>: <span class="st">'500px'</span>}) </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>cats<span class="op">=</span> <span class="bu">list</span>(gdf_epa[<span class="st">'cat'</span>].unique())</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> cat <span class="kw">in</span> cats:</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Generating maps for category: </span><span class="sc">{</span>cat<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># For each category, generate map plots using the MakeMaps function</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>        MakeMaps(gdf_epa, cat, inventory<span class="op">=</span><span class="st">"epa"</span>, analysis_year<span class="op">=</span>analysis_year)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>display(out)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Country United States not found in the shapefile.
Country United States not found in the shapefile.
Country United States not found in the shapefile.
Country United States not found in the shapefile.
****The output is a scrollable list of maps.***
Generating maps for category: livestock</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GHGC_Inventory_evaluation_maap_v2_files/figure-html/cell-9-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Generating maps for category: waste</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GHGC_Inventory_evaluation_maap_v2_files/figure-html/cell-9-output-4.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Generating maps for category: rice</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GHGC_Inventory_evaluation_maap_v2_files/figure-html/cell-9-output-6.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Generating maps for category: coal</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GHGC_Inventory_evaluation_maap_v2_files/figure-html/cell-9-output-8.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Generating maps for category: oil</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GHGC_Inventory_evaluation_maap_v2_files/figure-html/cell-9-output-10.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Generating maps for category: gas</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GHGC_Inventory_evaluation_maap_v2_files/figure-html/cell-9-output-12.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"cf0f6c4d00fd460798311281a83c49ef","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
</div>
<div id="cell-21" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a GeoPandas DataFrame from the analysis dictionary for the "epa" inventory</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>gdf_epa <span class="op">=</span> makeGeoPandasDataFrame(ana_dict, inventory<span class="op">=</span><span class="st">"epa"</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (<span class="st">"****The output is a scrollable list of maps.***"</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ipywidgets <span class="im">import</span> Output</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over each unique category in the 'cat' column of the GeoPandas DataFrame</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>out <span class="op">=</span> Output(layout<span class="op">=</span>{<span class="st">'overflow_y'</span>: <span class="st">'scroll'</span>, <span class="st">'height'</span>: <span class="st">'500px'</span>}) </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (gdf_epa[<span class="st">'cat'</span>].unique())</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> out:</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> cat <span class="kw">in</span> gdf_epa[<span class="st">'cat'</span>].unique():</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span> (cat)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># For each category, generate map plots using the MakeMaps function</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>        MakeMaps(gdf_epa, cat, inventory<span class="op">=</span><span class="st">"epa"</span>, analysis_year<span class="op">=</span> analysis_year)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>display(out)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Country United States not found in the shapefile.
Country United States not found in the shapefile.
Country United States not found in the shapefile.
Country United States not found in the shapefile.
****The output is a scrollable list of maps.***
['livestock' 'waste' 'rice' 'coal' 'oil' 'gas']</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"de35e77dc91942d991163f8bdabeacb7","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
</div>
<p>The difference between the two middle panels of each sector plot is due to the averaging kernel of the GOSAT flux inversion.</p>
</section>
</section>
<section id="edgar-inventory" class="level1">
<h1>EDGAR inventory</h1>
<p>Emissions Database for Global Atmospheric Research (EDGAR) Version 6</p>
<p>Monforti Ferrario, Fabio; Crippa, Monica; Guizzardi, Diego; Muntean, Marilena; Schaaf, Edwin; Lo Vullo, Eleonora; Solazzo, Efisio; Olivier, Jos; Vignati, Elisabetta (2021): EDGAR v6.0 Greenhouse Gas Emissions. European Commission, Joint Research Centre (JRC) [Dataset].</p>
<div id="cell-24" class="cell" data-tags="[]" data-execution_count="11">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read and process EDGAR inventory data for the specified analysis year</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>edgar_data_folder <span class="op">=</span> data_folder_path <span class="op">+</span> <span class="st">"/EDGAR_v6_2015_only/"</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>edgar_dat <span class="op">=</span> readEdgarData(edgar_data_folder, analysis_year<span class="op">=</span>analysis_year)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Integrate EDGAR inventory data into the analysis dictionary (ana_dict) for the year 2015</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>ana_dict <span class="op">=</span> addEdgar2AnaDict(ana_dict, edgar_dat, analysis_year<span class="op">=</span><span class="dv">2015</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ana_dict = FilterforCONUS(ana_dict)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading Edgar emission inventory Data for 2015
Adding Edgar data to ana_dict</code></pre>
</div>
</div>
<p>Note: We assume that EDGAR has the same sector-wise uncertainity as EPA.</p>
<div id="cell-26" class="cell" data-tags="[]" data-execution_count="12">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform AK correction on the analysis dictionary focusing on EDGAR data variables ("x_edgar" and "S_edgar")</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>ana_dict_edgar <span class="op">=</span> performAKcorrection(ana_dict, x_var<span class="op">=</span><span class="st">"x_edgar"</span>, S_var<span class="op">=</span><span class="st">"S_edgar"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Performing GOSAT flux inversions AK Correction</code></pre>
</div>
</div>
<div id="cell-27" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot comparison of EDGAR and GOSAT total emissions for each sector. </span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>makeBarPlot(ana_dict_edgar, epa_error_params, inventory<span class="op">=</span><span class="st">"edgar"</span>, analysis_year<span class="op">=</span>analysis_year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Country United States not found in the shapefile.
Country United States not found in the shapefile.
Country United States not found in the shapefile.
Country United States not found in the shapefile.</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GHGC_Inventory_evaluation_maap_v2_files/figure-html/cell-13-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-28" class="cell" data-tags="[]" data-execution_count="14">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a GeoPandas DataFrame from the analysis dictionary for the "edgar" inventory</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>gdf <span class="op">=</span> makeGeoPandasDataFrame(ana_dict, inventory<span class="op">=</span><span class="st">"edgar"</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (<span class="st">"***The output is a scrollable list of maps.***"</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>out <span class="op">=</span> Output(layout<span class="op">=</span>{<span class="st">'overflow_y'</span>: <span class="st">'scroll'</span>, <span class="st">'height'</span>: <span class="st">'500px'</span>})</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over each unique category in the 'cat' column of the GeoPandas DataFrame</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> out:</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> cat <span class="kw">in</span> gdf[<span class="st">'cat'</span>].unique():</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># For each category, generate map plots using the MakeMaps function</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>        MakeMaps(gdf, cat, inventory<span class="op">=</span><span class="st">"edgar"</span>, analysis_year<span class="op">=</span> analysis_year)</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>display(out)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Country United States not found in the shapefile.
Country United States not found in the shapefile.
Country United States not found in the shapefile.
Country United States not found in the shapefile.
***The output is a scrollable list of maps.***</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"ff4c8f35a2d8496c96edd1acd66dc981","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
</div>
</section>
<section id="fog-oilgas-fuel-inventory" class="level1">
<h1>FOG Oil/Gas Fuel Inventory</h1>
<p>Francoeur, C. B., McDonald, B. C., Gilman, J. B., Zarzana, K. J., Dix, B., Brown, S. S., de Gouw, J. A., Frost, G. J., Li, M., McKeen, S. A., Peischl, J., Pollack, I. B., Ryerson, T. B., Thompson, C., Warneke, C., and Trainer, M.: Quantifying Methane and Ozone Precursor Emissions from Oil and Gas Production Regions across the Contiguous US, Environ. Sci. Technol., 55, 9129–9139, https://doi.org/10.1021/acs.est.0c07352, 2021.</p>
<p>Note: We assume that FOG emissions have the same uncertainty as EPA oil/gas emissions.</p>
<div id="cell-30" class="cell" data-tags="[]" data-execution_count="15">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a oil/Gas fuel category within the GOSAT data dictionary to accommodate FOG emissions data</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>ana_dict_fog <span class="op">=</span> createFossilCategory(ana_dict)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust the resolution of the FOG data to match the GOSAT data dictionary's resolution</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co"># This involves clustering or aggregating the FOG data, which has a native resolution of 4x4 km^2</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>fog_data_path <span class="op">=</span> data_folder_path</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>ana_dict_fog <span class="op">=</span> clusterFOG2GOSAT(fog_data_path, ana_dict_fog, analysis_year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Creating Oil/Gas(= oil + gas) production Category
Clustering FOG data to GOSAT Grid Resolution</code></pre>
</div>
</div>
<div id="cell-31" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform AK correction for the oil/gas category using EPA data</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"EPA fossil:"</span>, end<span class="op">=</span><span class="st">" "</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>ana_dict_fog <span class="op">=</span> performAKcorrection(ana_dict_fog, x_var<span class="op">=</span><span class="st">"x_epa"</span>, S_var<span class="op">=</span><span class="st">"S_epa"</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform AK correction for the oil/gas category using FOG data</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"FOG fossil:"</span>, end<span class="op">=</span><span class="st">" "</span>)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>ana_dict_fog <span class="op">=</span> performAKcorrection(ana_dict_fog, x_var<span class="op">=</span><span class="st">"x_fog"</span>, S_var<span class="op">=</span><span class="st">"S_fog"</span>)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform AK correction for the oil/gas category using EDGAR data</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"EDGAR fossil:"</span>, end<span class="op">=</span><span class="st">" "</span>)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>ana_dict_fog <span class="op">=</span> performAKcorrection(ana_dict_fog, x_var<span class="op">=</span><span class="st">"x_edgar"</span>, S_var<span class="op">=</span><span class="st">"S_edgar"</span>)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Modify the error parameters for the oil/gas category to include contributions from gas and oil.</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="co"># This step assumes that the "gas" key in the `epa_error_params` dictionary is a placeholder and needs to be updated.</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>epa_error_params[<span class="st">"fossil"</span>] <span class="op">=</span> epa_error_params[<span class="st">"gas"</span>]  <span class="co"># This line needs modification to accurately represent fossil sources.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>EPA fossil: Performing GOSAT flux inversions AK Correction
FOG fossil: Performing GOSAT flux inversions AK Correction
EDGAR fossil: Performing GOSAT flux inversions AK Correction</code></pre>
</div>
</div>
<div id="cell-32" class="cell" data-tags="[]" data-execution_count="18">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plot of oil/gas emissions from the three inventories and GOSAT flux inversion</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>makeBarPlotFossil(ana_dict_fog, epa_error_params, inventory<span class="op">=</span><span class="st">"epa"</span>, analysis_year<span class="op">=</span>analysis_year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Country United States not found in the shapefile.
Country United States not found in the shapefile.
Country United States not found in the shapefile.
Country United States not found in the shapefile.</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GHGC_Inventory_evaluation_maap_v2_files/figure-html/cell-17-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The FOG estimates are in good agreement with GOSAT inversion estimates after applying the GOSAT averaging kernel. EPA and EDGAR estimates agree with each other (after applying GOSAT averaging kernel) but underestimate the GOSAT inversion and FOG estimates.</p>
<div id="cell-34" class="cell" data-tags="[]" data-execution_count="19">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create map plots for fossil fuel emissions</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co"># First, convert the analysis data into a GeoPandas DataFrame suitable for mapping</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>gdf_fog <span class="op">=</span> makeGeoPandasDataFrameFOG(ana_dict_fog)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Then, use the GeoPandas DataFrame to create maps of fossil fuel emissions for the specified analysis year</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>MakeFossilMaps(gdf_fog, analysis_year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Country United States not found in the shapefile.
Country United States not found in the shapefile.
Country United States not found in the shapefile.
Country United States not found in the shapefile.</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="GHGC_Inventory_evaluation_maap_v2_files/figure-html/cell-18-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<ol type="1">
<li><p><strong>Importance of Averaging Kernels:</strong> Accounting for truth sensitivity through the averaging kernel of flux inversions is essential for accurately evaluating methane emission inventories. This ensures that comparisons between bottom-up inventories and top-down satellite estimates are valid and reliable.</p></li>
<li><p><strong>Inventory Performance:</strong> The Fossil Oil and Gas (FOG) estimates closely align with GOSAT flux inversion results after applying the averaging kernel. In contrast, the EPA and EDGAR inventories, while consistent with each other after correction, tend to underestimate methane emissions compared to satellite-derived estimates.</p></li>
<li><p><strong>Implications and Future Directions:</strong> The underestimation by EPA and EDGAR suggests a need to enhance their methodologies by incorporating satellite-based data and refining emission factors.</p></li>
</ol>
<hr>
<p>This analysis highlights the necessity of integrating satellite-based flux inversions with traditional emission inventories to achieve a more accurate and comprehensive understanding of methane emissions. Addressing the identified discrepancies will improve emission assessments and inform better policy and mitigation efforts.</p>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/us-ghg-center\.github\.io\/ghgc-docs");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© CC-By US GHG Center, 2022-2023</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.dev/us-ghg-center/ghgc-docs/blob/main/user_data_notebooks/community_notebooks/ghgc_inv_eval_jpl/GHGC_Inventory_evaluation_maap_v2.ipynb" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/us-ghg-center/ghgc-docs/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This page is built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>